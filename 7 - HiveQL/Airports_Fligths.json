{"paragraphs":[{"text":"%jdbc(hive)\n\n--создание и наполнение объектов\n\nset hive.stats.autogather=true;\nset hive.vectorized.execution.enabled=true;\nset hive.vectorized.execution.reduce.enabled=true;\nset hive.auto.convert.join=true;\nset hive.auto.convert.join.noconditionaltask=true;\nset hive.exec.compress.intermediate=true;\n\n\ncreate database if not exists airline_db;\nuse airline_db;\n\ncreate external table if not exists raw_airports (\n    airport_id int,\n    city string,\n    state string,\n    name string\n)\ncomment 'Аэропорты'\nrow format delimited \nfields terminated by ',' \nstored as textfile\nlocation '/user/maria_dev/data/airports'\ntblproperties (\"skip.header.line.count\"=\"1\");\n\ncreate table if not exists airports (\n    airport_id int not null comment 'id аэропорта',\n    city string comment 'город аэропорта',\n    state string comment 'штат аэропорта',\n    name string comment 'название аэропорта'\n)\ncomment 'Аэропорты'\nclustered by (airport_id)\nsorted by (airport_id)\ninto 4 buckets\nstored as orc\ntblproperties (\n    \"orc.bloom.filter.columns\"=\"airport_id\",\n    \"orc.compress\"=\"SNAPPY\"\n);\n\ninsert overwrite table airports \nselect * from raw_airports;\n\n\ncreate external table raw_flights (\n    day_of_month int,\n    day_of_week string,\n    carrier string,\n    origin_airport_id int,\n    dest_airport_id int,\n    dep_delay int,\n    arr_delay int\n)\nrow format delimited \nfields terminated by ',' \nstored as textfile\nlocation '/user/maria_dev/data/flights'\ntblproperties (\"skip.header.line.count\"=\"1\");\n\ncreate table if not exists flights (\n    day_of_month int not null comment 'день месяца',\n    day_of_week string not null comment 'день недели',\n    origin_airport_id int not null comment 'аэропорт вылета',\n    dest_airport_id int not null comment 'аэропорт прилета',\n    dep_delay int comment 'задержка вылета',\n    arr_delay int comment 'задержка прибытия'\n)\ncomment 'Перелеты'\npartitioned by (carrier string comment 'перевозчик')\nclustered by (origin_airport_id)\nsorted by (day_of_month)\ninto 16 buckets\nstored as orc\ntblproperties (\n    \"orc.compress\"=\"SNAPPY\",\n    \"orc.bloom.filter.columns\"=\"origin_airport_id,dest_airport_id\"\n);\n\nset hive.exec.dynamic.partition = true;\nset hive.exec.dynamic.partition.mode = nonstrict;\n\ninsert into flights partition(carrier)\nselect \n    day_of_month,\n    day_of_week,\n    origin_airport_id,\n    dest_airport_id,\n    dep_delay,\n    arr_delay,\n    carrier -- д. быть последней\nfrom raw_flights;\n\n\ncreate materialized view if not exists v_airports_flights\ncomment 'всего аэропортов и перелетов'\nstored as parquet\nas \n    select 'all quantity airports' as src, count(*) as qty from airports\n    union \n    select 'all quantity fligths' as src, count(*) as qty from flights;\n\n\n\ncreate materialized view if not exists v_dayofweek_flights\ncomment 'количество перелетов по дням недели в разрезе перевозчиков'\nstored as orc\ntblproperties (\"orc.compress\"=\"SNAPPY\")\nas \nselect\n    carrier,\n    sum(case when day_of_week = 1 then 1 else 0 end) as mon_qty,\n    sum(case when day_of_week = 2 then 1 else 0 end) as tue_qty,\n    sum(case when day_of_week = 3 then 1 else 0 end) as wed_qty,\n    sum(case when day_of_week = 4 then 1 else 0 end) as thu_qty,\n    sum(case when day_of_week = 5 then 1 else 0 end) as fri_qty,\n    sum(case when day_of_week = 6 then 1 else 0 end) as sat_qty,\n    sum(case when day_of_week = 7 then 1 else 0 end) as sun_qty\nfrom flights\ngroup by carrier;\n\n\nalter table v_dayofweek_flights change column  carrier carrier string comment 'перевозчик';\nalter table v_dayofweek_flights change column  mon_qty mon_qty bigint comment'количество перелетов в понедельник';\nalter table v_dayofweek_flights change column  tue_qty tue_qty bigint comment'количество перелетов в вторник';\nalter table v_dayofweek_flights change column  wed_qty wed_qty bigint comment'количество перелетов в среду';\nalter table v_dayofweek_flights change column  thu_qty thu_qty bigint comment'количество перелетов в четверг';\nalter table v_dayofweek_flights change column  fri_qty fri_qty bigint comment'количество перелетов в пятницу';\nalter table v_dayofweek_flights change column  sat_qty sat_qty bigint comment'количество перелетов в субботу';\nalter table v_dayofweek_flights change column  sun_qty sun_qty bigint comment'количество перелетов в воскресенье';\n\n\n\ncreate materialized view if not exists v_popularity_destination \ncomment 'количество перелетов по направлениям'\nstored as orc\ntblproperties (\"orc.compress\"=\"SNAPPY\")\nas\nwith route_stats as (\n    select \n        origin_airport_id, \n        dest_airport_id, \n        count(*) as qty\n    from flights\n    group by \n        origin_airport_id, \n        dest_airport_id\n)\nselect \n    t.qty,\n    t.origin_airport_id as departure_id,\n    dep.city as departure_city,\n    dep.state as departure_state,\n    dep.name as departure_air,\n    t.dest_airport_id as arrival_id, \n    arr.city as arrival_city,\n    arr.state as arrival_state,\n    arr.name as arrival_air    \nfrom route_stats t\n    join airports dep on dep.airport_id = t.origin_airport_id\n    join airports arr on arr.airport_id = t.dest_airport_id;\n\n\nalter table v_popularity_destination change column qty qty bigint comment 'количество перелетов';\nalter table v_popularity_destination change column departure_id departure_id string comment 'id аэропорта вылета';\nalter table v_popularity_destination change column departure_city departure_city string comment 'город аэропорта вылета';\nalter table v_popularity_destination change column departure_state departure_state string comment 'штат аэропорта вылета';\nalter table v_popularity_destination change column departure_air departure_air string comment 'название аэропорта вылета';\n\nalter table v_popularity_destination change column arrival_id arrival_id string comment 'id аэропорта прибытия';\nalter table v_popularity_destination change column arrival_city arrival_city string comment 'город аэропорта прибытия';\nalter table v_popularity_destination change column arrival_state arrival_state string comment 'штат аэропорта прибытия';\nalter table v_popularity_destination change column arrival_air arrival_air string comment 'название аэропорта прибытия';\n\n\n\ncreate materialized view if not exists v_airport_congestion \ncomment 'загруженность аэропортов перелетами'\nstored as orc\ntblproperties (\"orc.compress\"=\"SNAPPY\")\nas \nwith depart_stats as (\n    select \n        origin_airport_id as airport_id, \n        count(*) as cnt\n    from flights\n    group by origin_airport_id\n),\narrival_stats as (\n    select \n        dest_airport_id as airport_id, \n        count(*) as cnt\n    from flights\n    group by dest_airport_id\n),\ntotal_traffic as (\n    select \n        airport_id, \n        sum(cnt) as qty\n    from (\n        select airport_id, cnt from depart_stats\n        union all\n        select airport_id, cnt from arrival_stats\n    ) t\n    group by airport_id\n    having (qty > 0)\n)\nselect\n    traf.airport_id,\n    air.city,\n    air.state,\n    air.name,\n    traf.qty\nfrom total_traffic traf\n    join airports air on air.airport_id = traf.airport_id;\n\nalter table v_airport_congestion change column airport_id airport_id int comment 'id аэропорта';\nalter table v_airport_congestion change column city city string comment 'город аэропорта';\nalter table v_airport_congestion change column state state string comment 'штат аэропорта';\nalter table v_airport_congestion change column name name string comment 'название аэропорта';\nalter table v_airport_congestion change column qty qty bigint comment 'количество перелетов аэропорта';\n\n\ncreate materialized view if not exists v_carrier_delay_stats\ncomment 'перевозчики которые чаще других задерживают вылеты и прилеты(средневзвешенно)'\nstored as orc\ntblproperties (\"orc.compress\"=\"SNAPPY\")\nas \nselect\n    carrier,\n    count(*) as total_flights,\n    round((sum(case when dep_delay > 15 then 1 else 0 end) / count(*)) * 100, 2) as pct_delayed_15min,\n    round(avg(case when dep_delay > 0 then dep_delay else 0 end), 2) as avg_dep_delay_weighted,\n    round(avg(case when arr_delay > 0 then arr_delay else 0 end), 2) as avg_arr_delay_weighted\nfrom flights\ngroup by carrier;\n\n\nalter table v_carrier_delay_stats change column carrier carrier string comment 'перевозчик';\nalter table v_carrier_delay_stats change column total_flights total_flights string comment 'всего полетов';\n\nalter table v_carrier_delay_stats change column pct_delayed_15min pct_delayed_15min double \ncomment 'процент рейсов, которые опоздали больше чем на 15 минут';\n\nalter table v_carrier_delay_stats change column avg_dep_delay_weighted avg_dep_delay_weighted double \ncomment 'среднее время, на которое самолеты опаздывают с вылетом';\n\nalter table v_carrier_delay_stats change column avg_arr_delay_weighted avg_arr_delay_weighted double \ncomment 'среднее время опоздания по прилету';\n\n","user":"maria_dev","dateUpdated":"2025-11-30T14:10:24+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1764509170457_-602422590","id":"20251130-132610_1231574038","dateCreated":"2025-11-30T13:26:10+0000","dateStarted":"2025-11-30T14:10:24+0000","dateFinished":"2025-11-30T14:11:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:63407"},{"text":"%jdbc(hive)\n\nuse airline_db;\n\n--данные и описания метаданных \n\n--внешние таблицы\nselect * from raw_flights limit 5;\nselect * from raw_airports limit 5;\n--таблицы\nselect * from flights limit 5;\nselect * from airports limit 5;\n\n--материализованные представления\nselect * from v_airports_flights limit 5;\nselect * from v_dayofweek_flights limit 5;\nselect * from v_carrier_delay_stats order by avg_dep_delay_weighted desc limit 5;\nselect * from v_airport_congestion order by qty desc limit 5;\nselect * from v_popularity_destination order by qty desc limit 5;\n\n\n--описание объектов\ndescribe formatted raw_flights;\ndescribe formatted raw_airports;\n\ndescribe formatted flights;\ndescribe formatted airports;\n\ndescribe formatted v_airport_congestion;\ndescribe formatted v_airports_flights;\ndescribe formatted v_carrier_delay_stats;\ndescribe formatted v_dayofweek_flights;\ndescribe formatted v_popularity_destination;","user":"maria_dev","dateUpdated":"2025-11-30T14:13:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"flights.day_of_month":"string","flights.day_of_week":"string","flights.origin_airport_id":"string","flights.dest_airport_id":"string","flights.dep_delay":"string","flights.arr_delay":"string","flights.carrier":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"raw_flights.day_of_month":"string","raw_flights.day_of_week":"string","raw_flights.carrier":"string","raw_flights.origin_airport_id":"string","raw_flights.dest_airport_id":"string","raw_flights.dep_delay":"string","raw_flights.arr_delay":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"7":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"v_carrier_delay_stats.carrier":"string","v_carrier_delay_stats.total_flights":"string","v_carrier_delay_stats.pct_delayed_15min":"string","v_carrier_delay_stats.avg_dep_delay_weighted":"string","v_carrier_delay_stats.avg_arr_delay_weighted":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"17":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"18":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TABLE","data":"raw_flights.day_of_month\traw_flights.day_of_week\traw_flights.carrier\traw_flights.origin_airport_id\traw_flights.dest_airport_id\traw_flights.dep_delay\traw_flights.arr_delay\n19\t5\tDL\t11433\t13303\t-3\t1\n19\t5\tDL\t14869\t12478\t0\t-8\n19\t5\tDL\t14057\t14869\t-4\t-15\n19\t5\tDL\t15016\t11433\t28\t24\n19\t5\tDL\t11193\t12892\t-6\t-11\n"},{"type":"TABLE","data":"raw_airports.airport_id\traw_airports.city\traw_airports.state\traw_airports.name\n10165\tAdak Island\tAK\tAdak\n10299\tAnchorage\tAK\tTed Stevens Anchorage International\n10304\tAniak\tAK\tAniak Airport\n10754\tBarrow\tAK\tWiley Post/Will Rogers Memorial\n10551\tBethel\tAK\tBethel Airport\n"},{"type":"TABLE","data":"flights.day_of_month\tflights.day_of_week\tflights.origin_airport_id\tflights.dest_airport_id\tflights.dep_delay\tflights.arr_delay\tflights.carrier\n1\t1\t10821\t14492\t73\t75\t9E\n1\t1\t10821\t14492\t-4\t2\t9E\n1\t1\t15304\t14492\t8\t-7\t9E\n1\t2\t10821\t14492\t-3\t-10\t9E\n1\t2\t10821\t11193\t-10\t-17\t9E\n"},{"type":"TABLE","data":"airports.airport_id\tairports.city\tairports.state\tairports.name\n10141\tAberdeen\tSD\tAberdeen Regional\n10158\tAtlantic City\tNJ\tAtlantic City International\n10245\tKing Salmon\tAK\tKing Salmon Airport\n10279\tAmarillo\tTX\tRick Husband Amarillo International\n10304\tAniak\tAK\tAniak Airport\n"},{"type":"TABLE","data":"v_airports_flights.src\tv_airports_flights.qty\nall quantity airports\t365\nall quantity fligths\t2702218\n"},{"type":"TABLE","data":"v_dayofweek_flights.carrier\tv_dayofweek_flights.mon_qty\tv_dayofweek_flights.tue_qty\tv_dayofweek_flights.wed_qty\tv_dayofweek_flights.thu_qty\tv_dayofweek_flights.fri_qty\tv_dayofweek_flights.sat_qty\tv_dayofweek_flights.sun_qty\n9E\t12419\t12225\t12503\t12336\t12119\t7118\t11311\nAA\t43168\t42336\t42618\t43020\t41876\t36098\t40739\nAS\t10164\t9954\t9907\t10089\t9805\t9139\t9497\nB6\t18137\t17461\t17377\t18121\t17654\t15785\t17371\nDL\t57067\t55348\t56972\t56908\t55721\t46176\t53465\n"},{"type":"TABLE","data":"v_carrier_delay_stats.carrier\tv_carrier_delay_stats.total_flights\tv_carrier_delay_stats.pct_delayed_15min\tv_carrier_delay_stats.avg_dep_delay_weighted\tv_carrier_delay_stats.avg_arr_delay_weighted\nMQ\t113212\t24.69\t17.72\t19.33\nEV\t157928\t22.9\t17.23\t17.51\nVX\t34739\t19.8\t16.56\t16.95\nB6\t121906\t21.98\t15.75\t16.91\nUA\t286418\t20.51\t14.63\t13.97\n"},{"type":"TABLE","data":"v_airport_congestion.airport_id\tv_airport_congestion.city\tv_airport_congestion.state\tv_airport_congestion.name\tv_airport_congestion.qty\n10397\tAtlanta\tGA\tHartsfield-Jackson Atlanta International\t297087\n13930\tChicago\tIL\tChicago O'Hare International\t254536\n12892\tLos Angeles\tCA\tLos Angeles International\t235988\n11298\tDallas/Fort Worth\tTX\tDallas/Fort Worth International\t208209\n11292\tDenver\tCO\tDenver International\t194178\n"},{"type":"TABLE","data":"v_popularity_destination.qty\tv_popularity_destination.departure_id\tv_popularity_destination.departure_city\tv_popularity_destination.departure_state\tv_popularity_destination.departure_air\tv_popularity_destination.arrival_id\tv_popularity_destination.arrival_city\tv_popularity_destination.arrival_state\tv_popularity_destination.arrival_air\n9643\t14771\tSan Francisco\tCA\tSan Francisco International\t12892\tLos Angeles\tCA\tLos Angeles International\n9583\t12892\tLos Angeles\tCA\tLos Angeles International\t14771\tSan Francisco\tCA\tSan Francisco International\n6864\t12892\tLos Angeles\tCA\tLos Angeles International\t12889\tLas Vegas\tNV\tMcCarran International\n6835\t12889\tLas Vegas\tNV\tMcCarran International\t12892\tLos Angeles\tCA\tLos Angeles International\n6643\t12478\tNew York\tNY\tJohn F. Kennedy International\t12892\tLos Angeles\tCA\tLos Angeles International\n"},{"type":"TABLE","data":"col_name\tdata_type\tcomment\n# col_name\tdata_type\tcomment\nday_of_month\tint\t\nday_of_week\tstring\t\ncarrier\tstring\t\norigin_airport_id\tint\t\ndest_airport_id\tint\t\ndep_delay\tint\t\narr_delay\tint\t\n\tnull\tnull\n# Detailed Table Information\tnull\tnull\nDatabase:           \tairline_db          \tnull\nOwnerType:          \tUSER                \tnull\nOwner:              \thive                \tnull\nCreateTime:         \tSun Nov 30 14:10:33 UTC 2025\tnull\nLastAccessTime:     \tUNKNOWN             \tnull\nRetention:          \t0                   \tnull\nLocation:           \thdfs://sandbox-hdp.hortonworks.com:8020/user/maria_dev/data/flights\tnull\nTable Type:         \tEXTERNAL_TABLE      \tnull\nTable Parameters:\tnull\tnull\n\tEXTERNAL            \tTRUE                \n\tbucketing_version   \t2                   \n\tnumFiles            \t1                   \n\tskip.header.line.count\t1                   \n\ttotalSize           \t72088113            \n\ttransient_lastDdlTime\t1764511833          \n\tnull\tnull\n# Storage Information\tnull\tnull\nSerDe Library:      \torg.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\tnull\nInputFormat:        \torg.apache.hadoop.mapred.TextInputFormat\tnull\nOutputFormat:       \torg.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\tnull\nCompressed:         \tNo                  \tnull\nNum Buckets:        \t-1                  \tnull\nBucket Columns:     \t[]                  \tnull\nSort Columns:       \t[]                  \tnull\nStorage Desc Params:\tnull\tnull\n\tfield.delim         \t,                   \n\tserialization.format\t,                   \n"},{"type":"TABLE","data":"col_name\tdata_type\tcomment\n# col_name\tdata_type\tcomment\nairport_id\tint\t\ncity\tstring\t\nstate\tstring\t\nname\tstring\t\n\tnull\tnull\n# Detailed Table Information\tnull\tnull\nDatabase:           \tairline_db          \tnull\nOwnerType:          \tUSER                \tnull\nOwner:              \thive                \tnull\nCreateTime:         \tSun Nov 30 14:10:24 UTC 2025\tnull\nLastAccessTime:     \tUNKNOWN             \tnull\nRetention:          \t0                   \tnull\nLocation:           \thdfs://sandbox-hdp.hortonworks.com:8020/user/maria_dev/data/airports\tnull\nTable Type:         \tEXTERNAL_TABLE      \tnull\nTable Parameters:\tnull\tnull\n\tEXTERNAL            \tTRUE                \n\tbucketing_version   \t2                   \n\tcomment             \tАэропорты           \n\tnumFiles            \t1                   \n\tskip.header.line.count\t1                   \n\ttotalSize           \t16308               \n\ttransient_lastDdlTime\t1764511824          \n\tnull\tnull\n# Storage Information\tnull\tnull\nSerDe Library:      \torg.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\tnull\nInputFormat:        \torg.apache.hadoop.mapred.TextInputFormat\tnull\nOutputFormat:       \torg.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\tnull\nCompressed:         \tNo                  \tnull\nNum Buckets:        \t-1                  \tnull\nBucket Columns:     \t[]                  \tnull\nSort Columns:       \t[]                  \tnull\nStorage Desc Params:\tnull\tnull\n\tfield.delim         \t,                   \n\tserialization.format\t,                   \n"},{"type":"TABLE","data":"col_name\tdata_type\tcomment\n# col_name\tdata_type\tcomment\nday_of_month\tint\tдень месяца\nday_of_week\tstring\tдень недели\norigin_airport_id\tint\tаэропорт вылета\ndest_airport_id\tint\tаэропорт прилета\ndep_delay\tint\tзадержка вылета\narr_delay\tint\tзадержка прибытия\n\tnull\tnull\n# Partition Information\tnull\tnull\n# col_name\tdata_type\tcomment\ncarrier\tstring\tперевозчик\n\tnull\tnull\n# Detailed Table Information\tnull\tnull\nDatabase:           \tairline_db          \tnull\nOwnerType:          \tUSER                \tnull\nOwner:              \thive                \tnull\nCreateTime:         \tSun Nov 30 14:10:33 UTC 2025\tnull\nLastAccessTime:     \tUNKNOWN             \tnull\nRetention:          \t0                   \tnull\nLocation:           \thdfs://sandbox-hdp.hortonworks.com:8020/warehouse/tablespace/managed/hive/airline_db.db/flights\tnull\nTable Type:         \tMANAGED_TABLE       \tnull\nTable Parameters:\tnull\tnull\n\tCOLUMN_STATS_ACCURATE\t{\\\"BASIC_STATS\\\":\\\"true\\\"}\n\tbucketing_version   \t2                   \n\tcomment             \tПерелеты            \n\tnumFiles            \t233                 \n\tnumPartitions       \t16                  \n\tnumRows             \t2702218             \n\torc.bloom.filter.columns\torigin_airport_id,dest_airport_id\n\torc.compress        \tSNAPPY              \n\trawDataSize         \t283732890           \n\ttotalSize           \t10932272            \n\ttransactional       \ttrue                \n\ttransactional_properties\tinsert_only         \n\ttransient_lastDdlTime\t1764511833          \n\tnull\tnull\n# Storage Information\tnull\tnull\nSerDe Library:      \torg.apache.hadoop.hive.ql.io.orc.OrcSerde\tnull\nInputFormat:        \torg.apache.hadoop.hive.ql.io.orc.OrcInputFormat\tnull\nOutputFormat:       \torg.apache.hadoop.hive.ql.io.orc.OrcOutputFormat\tnull\nCompressed:         \tNo                  \tnull\nNum Buckets:        \t16                  \tnull\nBucket Columns:     \t[origin_airport_id] \tnull\nSort Columns:       \t[Order(col:day_of_month, order:1)]\tnull\nStorage Desc Params:\tnull\tnull\n\tserialization.format\t1                   \n\tnull\tnull\n# Constraints\tnull\tnull\n\tnull\tnull\n# Not Null Constraints\tnull\tnull\nTable:              \tairline_db.flights  \tnull\nConstraint Name:    \tnn_141404898_1764511833199_0\tnull\nColumn Name:        \tdest_airport_id     \tnull\n\tnull\tnull\nConstraint Name:    \tnn_253539486_1764511833198_0\tnull\nColumn Name:        \torigin_airport_id   \tnull\n\tnull\tnull\nConstraint Name:    \tnn_45007823_1764511833197_0\tnull\nColumn Name:        \tday_of_week         \tnull\n\tnull\tnull\nConstraint Name:    \tnn_99374087_1764511833195_0\tnull\nColumn Name:        \tday_of_month        \tnull\n\tnull\tnull\n"},{"type":"TABLE","data":"col_name\tdata_type\tcomment\n# col_name\tdata_type\tcomment\nairport_id\tint\tid аэропорта\ncity\tstring\tгород аэропорта\nstate\tstring\tштат аэропорта\nname\tstring\tназвание аэропорта\n\tnull\tnull\n# Detailed Table Information\tnull\tnull\nDatabase:           \tairline_db          \tnull\nOwnerType:          \tUSER                \tnull\nOwner:              \thive                \tnull\nCreateTime:         \tSun Nov 30 14:10:24 UTC 2025\tnull\nLastAccessTime:     \tUNKNOWN             \tnull\nRetention:          \t0                   \tnull\nLocation:           \thdfs://sandbox-hdp.hortonworks.com:8020/warehouse/tablespace/managed/hive/airline_db.db/airports\tnull\nTable Type:         \tMANAGED_TABLE       \tnull\nTable Parameters:\tnull\tnull\n\tCOLUMN_STATS_ACCURATE\t{\\\"BASIC_STATS\\\":\\\"true\\\",\\\"COLUMN_STATS\\\":{\\\"airport_id\\\":\\\"true\\\",\\\"city\\\":\\\"true\\\",\\\"name\\\":\\\"true\\\",\\\"state\\\":\\\"true\\\"}}\n\tSORTBUCKETCOLSPREFIX\tTRUE                \n\tbucketing_version   \t2                   \n\tcomment             \tАэропорты           \n\tnumFiles            \t4                   \n\tnumRows             \t365                 \n\torc.bloom.filter.columns\tairport_id          \n\torc.compress        \tSNAPPY              \n\trawDataSize         \t105673              \n\ttotalSize           \t19239               \n\ttransactional       \ttrue                \n\ttransactional_properties\tinsert_only         \n\ttransient_lastDdlTime\t1764511832          \n\tnull\tnull\n# Storage Information\tnull\tnull\nSerDe Library:      \torg.apache.hadoop.hive.ql.io.orc.OrcSerde\tnull\nInputFormat:        \torg.apache.hadoop.hive.ql.io.orc.OrcInputFormat\tnull\nOutputFormat:       \torg.apache.hadoop.hive.ql.io.orc.OrcOutputFormat\tnull\nCompressed:         \tNo                  \tnull\nNum Buckets:        \t4                   \tnull\nBucket Columns:     \t[airport_id]        \tnull\nSort Columns:       \t[Order(col:airport_id, order:1)]\tnull\nStorage Desc Params:\tnull\tnull\n\tserialization.format\t1                   \n\tnull\tnull\n# Constraints\tnull\tnull\n\tnull\tnull\n# Not Null Constraints\tnull\tnull\nTable:              \tairline_db.airports \tnull\nConstraint Name:    \tnn_147811570_1764511824451_0\tnull\nColumn Name:        \tairport_id          \tnull\n\tnull\tnull\n"},{"type":"TABLE","data":"col_name\tdata_type\tcomment\n# col_name\tdata_type\tcomment\nairport_id\tint\tid аэропорта\ncity\tstring\tгород аэропорта\nstate\tstring\tштат аэропорта\nname\tstring\tназвание аэропорта\nqty\tbigint\tколичество перелетов аэропорта\n\tnull\tnull\n# Detailed Table Information\tnull\tnull\nDatabase:           \tairline_db          \tnull\nOwnerType:          \tUSER                \tnull\nOwner:              \thive                \tnull\nCreateTime:         \tSun Nov 30 14:11:39 UTC 2025\tnull\nLastAccessTime:     \tUNKNOWN             \tnull\nRetention:          \t0                   \tnull\nLocation:           \thdfs://sandbox-hdp.hortonworks.com:8020/warehouse/tablespace/managed/hive/airline_db.db/v_airport_congestion\tnull\nTable Type:         \tMATERIALIZED_VIEW   \tnull\nTable Parameters:\tnull\tnull\n\tCOLUMN_STATS_ACCURATE\t{\\\"BASIC_STATS\\\":\\\"true\\\"}\n\tbucketing_version   \t2                   \n\tcomment             \tзагруженность аэропортов перелетами\n\tlast_modified_by    \thive                \n\tlast_modified_time  \t1764511900          \n\tnumFiles            \t1                   \n\tnumRows             \t70                  \n\torc.compress        \tSNAPPY              \n\trawDataSize         \t21070               \n\ttotalSize           \t3303                \n\ttransient_lastDdlTime\t1764511900          \n\tnull\tnull\n# Storage Information\tnull\tnull\nSerDe Library:      \torg.apache.hadoop.hive.ql.io.orc.OrcSerde\tnull\nInputFormat:        \torg.apache.hadoop.hive.ql.io.orc.OrcInputFormat\tnull\nOutputFormat:       \torg.apache.hadoop.hive.ql.io.orc.OrcOutputFormat\tnull\nCompressed:         \tNo                  \tnull\nNum Buckets:        \t-1                  \tnull\nBucket Columns:     \t[]                  \tnull\nSort Columns:       \t[]                  \tnull\n\tnull\tnull\n# Materialized View Information\tnull\tnull\nOriginal Query:     \twith depart_stats as (\tnull\n\t                    \t    select          \n\t                    \t        origin_airport_id as airport_id, \n\t                    \t        count(*) as cnt\n\t                    \t    from flights    \n\t                    \t    group by origin_airport_id\n\t                    \t),                  \n\t                    \tarrival_stats as (  \n\t                    \t    select          \n\t                    \t        dest_airport_id as airport_id, \n\t                    \t        count(*) as cnt\n\t                    \t    from flights    \n\t                    \t    group by dest_airport_id\n\t                    \t),                  \n\t                    \ttotal_traffic as (  \n\t                    \t    select          \n\t                    \t        airport_id, \n\t                    \t        sum(cnt) as qty\n\t                    \t    from (          \n\t                    \t        select airport_id, cnt from depart_stats\n\t                    \t        union all   \n\t                    \t        select airport_id, cnt from arrival_stats\n\t                    \t    ) t             \n\t                    \t    group by airport_id\n\t                    \t    having (qty > 0)\n\t                    \t)                   \n\t                    \tselect              \n\t                    \t    traf.airport_id,\n\t                    \t    air.city,       \n\t                    \t    air.state,      \n\t                    \t    air.name,       \n\t                    \t    traf.qty        \n\t                    \tfrom total_traffic traf\n\t                    \t    join airports air on air.airport_id = traf.airport_id\nExpanded Query:     \twith depart_stats as (\tnull\n\t                    \t    select          \n\t                    \t        `flights`.`origin_airport_id` as `airport_id`, \n\t                    \t        count(*) as `cnt`\n\t                    \t    from `airline_db`.`flights`\n\t                    \t    group by `flights`.`origin_airport_id`\n\t                    \t),                  \n\t                    \tarrival_stats as (  \n\t                    \t    select          \n\t                    \t        `flights`.`dest_airport_id` as `airport_id`, \n\t                    \t        count(*) as `cnt`\n\t                    \t    from `airline_db`.`flights`\n\t                    \t    group by `flights`.`dest_airport_id`\n\t                    \t),                  \n\t                    \ttotal_traffic as (  \n\t                    \t    select          \n\t                    \t        `t`.`airport_id`, \n\t                    \t        sum(`t`.`cnt`) as `qty`\n\t                    \t    from (          \n\t                    \t        select `depart_stats`.`airport_id`, `depart_stats`.`cnt` from depart_stats\n\t                    \t        union all   \n\t                    \t        select `arrival_stats`.`airport_id`, `arrival_stats`.`cnt` from arrival_stats\n\t                    \t    ) `t`           \n\t                    \t    group by `t`.`airport_id`\n\t                    \t    having (qty > 0)\n\t                    \t)                   \n\t                    \tselect              \n\t                    \t    `traf`.`airport_id`,\n\t                    \t    `air`.`city`,   \n\t                    \t    `air`.`state`,  \n\t                    \t    `air`.`name`,   \n\t                    \t    `traf`.`qty`    \n\t                    \tfrom total_traffic traf\n\t                    \t    join `airline_db`.`airports` `air` on `air`.`airport_id` = `traf`.`airport_id`\nRewrite Enabled:    \tYes                 \tnull\nOutdated for Rewriting:\tNo                  \tnull\n"},{"type":"TABLE","data":"col_name\tdata_type\tcomment\n# col_name\tdata_type\tcomment\nsrc\tstring\t\nqty\tbigint\t\n\tnull\tnull\n# Detailed Table Information\tnull\tnull\nDatabase:           \tairline_db          \tnull\nOwnerType:          \tUSER                \tnull\nOwner:              \thive                \tnull\nCreateTime:         \tSun Nov 30 14:11:16 UTC 2025\tnull\nLastAccessTime:     \tUNKNOWN             \tnull\nRetention:          \t0                   \tnull\nLocation:           \thdfs://sandbox-hdp.hortonworks.com:8020/warehouse/tablespace/managed/hive/airline_db.db/v_airports_flights\tnull\nTable Type:         \tMATERIALIZED_VIEW   \tnull\nTable Parameters:\tnull\tnull\n\tCOLUMN_STATS_ACCURATE\t{\\\"BASIC_STATS\\\":\\\"true\\\"}\n\tbucketing_version   \t2                   \n\tcomment             \tвсего аэропортов и перелетов\n\tnumFiles            \t2                   \n\tnumRows             \t2                   \n\trawDataSize         \t4                   \n\ttotalSize           \t1195                \n\ttransient_lastDdlTime\t1764511876          \n\tnull\tnull\n# Storage Information\tnull\tnull\nSerDe Library:      \torg.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe\tnull\nInputFormat:        \torg.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat\tnull\nOutputFormat:       \torg.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat\tnull\nCompressed:         \tNo                  \tnull\nNum Buckets:        \t-1                  \tnull\nBucket Columns:     \t[]                  \tnull\nSort Columns:       \t[]                  \tnull\n\tnull\tnull\n# Materialized View Information\tnull\tnull\nOriginal Query:     \tselect 'all quantity airports' as src, count(*) as qty from airports\tnull\n\t                    \t    union           \n\t                    \t    select 'all quantity fligths' as src, count(*) as qty from flights\nExpanded Query:     \tselect 'all quantity airports' as `src`, count(*) as `qty` from `airline_db`.`airports`\tnull\n\t                    \t    union           \n\t                    \t    select 'all quantity fligths' as `src`, count(*) as `qty` from `airline_db`.`flights`\nRewrite Enabled:    \tYes                 \tnull\nOutdated for Rewriting:\tNo                  \tnull\n"},{"type":"TABLE","data":"col_name\tdata_type\tcomment\n# col_name\tdata_type\tcomment\ncarrier\tstring\tперевозчик\ntotal_flights\tstring\tвсего полетов\npct_delayed_15min\tdouble\tпроцент рейсов, которые опоздали больше чем на 15 минут\navg_dep_delay_weighted\tdouble\tсреднее время, на которое самолеты опаздывают с вылетом\navg_arr_delay_weighted\tdouble\tсреднее время опоздания по прилету\n\tnull\tnull\n# Detailed Table Information\tnull\tnull\nDatabase:           \tairline_db          \tnull\nOwnerType:          \tUSER                \tnull\nOwner:              \thive                \tnull\nCreateTime:         \tSun Nov 30 14:11:44 UTC 2025\tnull\nLastAccessTime:     \tUNKNOWN             \tnull\nRetention:          \t0                   \tnull\nLocation:           \thdfs://sandbox-hdp.hortonworks.com:8020/warehouse/tablespace/managed/hive/airline_db.db/v_carrier_delay_stats\tnull\nTable Type:         \tMATERIALIZED_VIEW   \tnull\nTable Parameters:\tnull\tnull\n\tCOLUMN_STATS_ACCURATE\t{\\\"BASIC_STATS\\\":\\\"true\\\"}\n\tbucketing_version   \t2                   \n\tcomment             \tперевозчики которые чаще других задерживают вылеты и прилеты(средневзвешенно)\n\tlast_modified_by    \thive                \n\tlast_modified_time  \t1764511905          \n\tnumFiles            \t1                   \n\tnumRows             \t16                  \n\torc.compress        \tSNAPPY              \n\trawDataSize         \t1888                \n\ttotalSize           \t1228                \n\ttransient_lastDdlTime\t1764511905          \n\tnull\tnull\n# Storage Information\tnull\tnull\nSerDe Library:      \torg.apache.hadoop.hive.ql.io.orc.OrcSerde\tnull\nInputFormat:        \torg.apache.hadoop.hive.ql.io.orc.OrcInputFormat\tnull\nOutputFormat:       \torg.apache.hadoop.hive.ql.io.orc.OrcOutputFormat\tnull\nCompressed:         \tNo                  \tnull\nNum Buckets:        \t-1                  \tnull\nBucket Columns:     \t[]                  \tnull\nSort Columns:       \t[]                  \tnull\n\tnull\tnull\n# Materialized View Information\tnull\tnull\nOriginal Query:     \tselect              \tnull\n\t                    \t    carrier,        \n\t                    \t    count(*) as total_flights,\n\t                    \t    round((sum(case when dep_delay > 15 then 1 else 0 end) / count(*)) * 100, 2) as pct_delayed_15min,\n\t                    \t    round(avg(case when dep_delay > 0 then dep_delay else 0 end), 2) as avg_dep_delay_weighted,\n\t                    \t    round(avg(case when arr_delay > 0 then arr_delay else 0 end), 2) as avg_arr_delay_weighted\n\t                    \tfrom flights        \n\t                    \tgroup by carrier    \nExpanded Query:     \tselect              \tnull\n\t                    \t    `flights`.`carrier`,\n\t                    \t    count(*) as `total_flights`,\n\t                    \t    round((sum(case when `flights`.`dep_delay` > 15 then 1 else 0 end) / count(*)) * 100, 2) as `pct_delayed_15min`,\n\t                    \t    round(avg(case when `flights`.`dep_delay` > 0 then `flights`.`dep_delay` else 0 end), 2) as `avg_dep_delay_weighted`,\n\t                    \t    round(avg(case when `flights`.`arr_delay` > 0 then `flights`.`arr_delay` else 0 end), 2) as `avg_arr_delay_weighted`\n\t                    \tfrom `airline_db`.`flights`\n\t                    \tgroup by `flights`.`carrier`\nRewrite Enabled:    \tYes                 \tnull\nOutdated for Rewriting:\tNo                  \tnull\n"},{"type":"TABLE","data":"col_name\tdata_type\tcomment\n# col_name\tdata_type\tcomment\ncarrier\tstring\tперевозчик\nmon_qty\tbigint\tколичество перелетов в понедельник\ntue_qty\tbigint\tколичество перелетов в вторник\nwed_qty\tbigint\tколичество перелетов в среду\nthu_qty\tbigint\tколичество перелетов в четверг\nfri_qty\tbigint\tколичество перелетов в пятницу\nsat_qty\tbigint\tколичество перелетов в субботу\nsun_qty\tbigint\tколичество перелетов в воскресенье\n\tnull\tnull\n# Detailed Table Information\tnull\tnull\nDatabase:           \tairline_db          \tnull\nOwnerType:          \tUSER                \tnull\nOwner:              \thive                \tnull\nCreateTime:         \tSun Nov 30 14:11:21 UTC 2025\tnull\nLastAccessTime:     \tUNKNOWN             \tnull\nRetention:          \t0                   \tnull\nLocation:           \thdfs://sandbox-hdp.hortonworks.com:8020/warehouse/tablespace/managed/hive/airline_db.db/v_dayofweek_flights\tnull\nTable Type:         \tMATERIALIZED_VIEW   \tnull\nTable Parameters:\tnull\tnull\n\tCOLUMN_STATS_ACCURATE\t{\\\"BASIC_STATS\\\":\\\"true\\\"}\n\tbucketing_version   \t2                   \n\tcomment             \tколичество перелетов по дням недели в разрезе перевозчиков\n\tlast_modified_by    \thive                \n\tlast_modified_time  \t1764511883          \n\tnumFiles            \t1                   \n\tnumRows             \t16                  \n\torc.compress        \tSNAPPY              \n\trawDataSize         \t2272                \n\ttotalSize           \t1179                \n\ttransient_lastDdlTime\t1764511883          \n\tnull\tnull\n# Storage Information\tnull\tnull\nSerDe Library:      \torg.apache.hadoop.hive.ql.io.orc.OrcSerde\tnull\nInputFormat:        \torg.apache.hadoop.hive.ql.io.orc.OrcInputFormat\tnull\nOutputFormat:       \torg.apache.hadoop.hive.ql.io.orc.OrcOutputFormat\tnull\nCompressed:         \tNo                  \tnull\nNum Buckets:        \t-1                  \tnull\nBucket Columns:     \t[]                  \tnull\nSort Columns:       \t[]                  \tnull\n\tnull\tnull\n# Materialized View Information\tnull\tnull\nOriginal Query:     \tselect              \tnull\n\t                    \t    carrier,        \n\t                    \t    sum(case when day_of_week = 1 then 1 else 0 end) as mon_qty,\n\t                    \t    sum(case when day_of_week = 2 then 1 else 0 end) as tue_qty,\n\t                    \t    sum(case when day_of_week = 3 then 1 else 0 end) as wed_qty,\n\t                    \t    sum(case when day_of_week = 4 then 1 else 0 end) as thu_qty,\n\t                    \t    sum(case when day_of_week = 5 then 1 else 0 end) as fri_qty,\n\t                    \t    sum(case when day_of_week = 6 then 1 else 0 end) as sat_qty,\n\t                    \t    sum(case when day_of_week = 7 then 1 else 0 end) as sun_qty\n\t                    \tfrom flights        \n\t                    \tgroup by carrier    \nExpanded Query:     \tselect              \tnull\n\t                    \t    `flights`.`carrier`,\n\t                    \t    sum(case when `flights`.`day_of_week` = 1 then 1 else 0 end) as `mon_qty`,\n\t                    \t    sum(case when `flights`.`day_of_week` = 2 then 1 else 0 end) as `tue_qty`,\n\t                    \t    sum(case when `flights`.`day_of_week` = 3 then 1 else 0 end) as `wed_qty`,\n\t                    \t    sum(case when `flights`.`day_of_week` = 4 then 1 else 0 end) as `thu_qty`,\n\t                    \t    sum(case when `flights`.`day_of_week` = 5 then 1 else 0 end) as `fri_qty`,\n\t                    \t    sum(case when `flights`.`day_of_week` = 6 then 1 else 0 end) as `sat_qty`,\n\t                    \t    sum(case when `flights`.`day_of_week` = 7 then 1 else 0 end) as `sun_qty`\n\t                    \tfrom `airline_db`.`flights`\n\t                    \tgroup by `flights`.`carrier`\nRewrite Enabled:    \tYes                 \tnull\nOutdated for Rewriting:\tNo                  \tnull\n"},{"type":"TABLE","data":"col_name\tdata_type\tcomment\n# col_name\tdata_type\tcomment\nqty\tbigint\tколичество перелетов\ndeparture_id\tstring\tid аэропорта вылета\ndeparture_city\tstring\tгород аэропорта вылета\ndeparture_state\tstring\tштат аэропорта вылета\ndeparture_air\tstring\tназвание аэропорта вылета\narrival_id\tstring\tid аэропорта прибытия\narrival_city\tstring\tгород аэропорта прибытия\narrival_state\tstring\tштат аэропорта прибытия\narrival_air\tstring\tназвание аэропорта прибытия\n\tnull\tnull\n# Detailed Table Information\tnull\tnull\nDatabase:           \tairline_db          \tnull\nOwnerType:          \tUSER                \tnull\nOwner:              \thive                \tnull\nCreateTime:         \tSun Nov 30 14:11:30 UTC 2025\tnull\nLastAccessTime:     \tUNKNOWN             \tnull\nRetention:          \t0                   \tnull\nLocation:           \thdfs://sandbox-hdp.hortonworks.com:8020/warehouse/tablespace/managed/hive/airline_db.db/v_popularity_destination\tnull\nTable Type:         \tMATERIALIZED_VIEW   \tnull\nTable Parameters:\tnull\tnull\n\tCOLUMN_STATS_ACCURATE\t{\\\"BASIC_STATS\\\":\\\"true\\\"}\n\tbucketing_version   \t2                   \n\tcomment             \tколичество перелетов по направлениям\n\tlast_modified_by    \thive                \n\tlast_modified_time  \t1764511892          \n\tnumFiles            \t1                   \n\tnumRows             \t2513                \n\torc.compress        \tSNAPPY              \n\trawDataSize         \t1497748             \n\ttotalSize           \t17193               \n\ttransient_lastDdlTime\t1764511892          \n\tnull\tnull\n# Storage Information\tnull\tnull\nSerDe Library:      \torg.apache.hadoop.hive.ql.io.orc.OrcSerde\tnull\nInputFormat:        \torg.apache.hadoop.hive.ql.io.orc.OrcInputFormat\tnull\nOutputFormat:       \torg.apache.hadoop.hive.ql.io.orc.OrcOutputFormat\tnull\nCompressed:         \tNo                  \tnull\nNum Buckets:        \t-1                  \tnull\nBucket Columns:     \t[]                  \tnull\nSort Columns:       \t[]                  \tnull\n\tnull\tnull\n# Materialized View Information\tnull\tnull\nOriginal Query:     \twith route_stats as (\tnull\n\t                    \t    select          \n\t                    \t        origin_airport_id, \n\t                    \t        dest_airport_id, \n\t                    \t        count(*) as qty\n\t                    \t    from flights    \n\t                    \t    group by        \n\t                    \t        origin_airport_id, \n\t                    \t        dest_airport_id\n\t                    \t)                   \n\t                    \tselect              \n\t                    \t    t.qty,          \n\t                    \t    t.origin_airport_id as departure_id,\n\t                    \t    dep.city as departure_city,\n\t                    \t    dep.state as departure_state,\n\t                    \t    dep.name as departure_air,\n\t                    \t    t.dest_airport_id as arrival_id, \n\t                    \t    arr.city as arrival_city,\n\t                    \t    arr.state as arrival_state,\n\t                    \t    arr.name as arrival_air    \n\t                    \tfrom route_stats t  \n\t                    \t    join airports dep on dep.airport_id = t.origin_airport_id\n\t                    \t    join airports arr on arr.airport_id = t.dest_airport_id\nExpanded Query:     \twith route_stats as (\tnull\n\t                    \t    select          \n\t                    \t        `flights`.`origin_airport_id`, \n\t                    \t        `flights`.`dest_airport_id`, \n\t                    \t        count(*) as `qty`\n\t                    \t    from `airline_db`.`flights`\n\t                    \t    group by        \n\t                    \t        `flights`.`origin_airport_id`, \n\t                    \t        `flights`.`dest_airport_id`\n\t                    \t)                   \n\t                    \tselect              \n\t                    \t    `t`.`qty`,      \n\t                    \t    `t`.`origin_airport_id` as `departure_id`,\n\t                    \t    `dep`.`city` as `departure_city`,\n\t                    \t    `dep`.`state` as `departure_state`,\n\t                    \t    `dep`.`name` as `departure_air`,\n\t                    \t    `t`.`dest_airport_id` as `arrival_id`, \n\t                    \t    `arr`.`city` as `arrival_city`,\n\t                    \t    `arr`.`state` as `arrival_state`,\n\t                    \t    `arr`.`name` as `arrival_air`    \n\t                    \tfrom route_stats t  \n\t                    \t    join `airline_db`.`airports` `dep` on `dep`.`airport_id` = `t`.`origin_airport_id`\n\t                    \t    join `airline_db`.`airports` `arr` on `arr`.`airport_id` = `t`.`dest_airport_id`\nRewrite Enabled:    \tYes                 \tnull\nOutdated for Rewriting:\tNo                  \tnull\n"}]},"apps":[],"jobName":"paragraph_1764509724083_1851495496","id":"20251130-133524_641073375","dateCreated":"2025-11-30T13:35:24+0000","dateStarted":"2025-11-30T14:13:25+0000","dateFinished":"2025-11-30T14:13:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:63408"},{"text":"%jdbc\n","user":"maria_dev","dateUpdated":"2025-11-30T13:34:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{},"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1764509214937_-743499186","id":"20251130-132654_2137986247","dateCreated":"2025-11-30T13:26:54+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:63409"}],"name":"Airports_Fligths","id":"2MBRD3EQM","noteParams":{},"noteForms":{},"angularObjects":{"jdbc:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}